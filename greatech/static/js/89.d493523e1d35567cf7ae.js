webpackJsonp([89],{MsoX:function(e,t){},yOfV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Dd8w"),i=r.n(a),n=r("T452"),o=r("pxwZ"),s=r("/ksa"),l=r("lStc"),u=r("uUlv"),m=new(r("7blw").a),c={name:"replenishAuxiliary",data:function(){var e=this;return{form:{rmNumber:"",printableQuantity:"",mpAmount:"",qgPeriod:"",dProductUuid:"",materialCodingName:"",materialCoding:"",quantity:"",deliveryCount:"",mpCount:"",issuanceDate:l.a.getToday("-"),manufactureDate:l.a.getToday("-")},restaurants:[],materielList:[],rules:{rmNumber:[{required:!0,message:"请输入补货单号",trigger:["blur","change"]}],deliveryCount:[{validator:function(t,r,a){return""===r?a(new Error("送货数不能为空")):/^[0-9]*[1-9][0-9]*$/.test(r)?Number(e.form.deliveryCount)>Number(e.form.printableQuantity)?a(new Error("送货数不能大于可打印数")):void a():a(new Error("只能输入整数"))},required:!0,trigger:"blur"}],mpAmount:[{validator:s.e,required:!0,trigger:"blur"}],issuanceDate:[{required:!0,message:"请选择日期",trigger:["change"]}],materialCodingName:[{required:!0,message:"内容不能为空",trigger:["blur","change"]}],qgPeriod:[{required:!0,message:"请选择日期",trigger:["change"]}],manufactureDate:[{required:!0,message:"请选择日期",trigger:["change"]}]},selcetRmNumber:"",erpno:""}},mounted:function(){this.getDeliveryNote(),this.changeBarCodeList([])},methods:i()({},Object(u.b)(["changeBarCodeList"]),{querySearch:function(e,t){var r=this.restaurants;t(e?r.filter(this.createFilter(e)):r)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},materielSearch:function(e,t){var r=this.materielList;t(e?r.filter(this.materielFilter(e)):r)},materielFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},getDeliveryNote:function(){var e=this;o.a.post(n.a.api,"/replenishment/getReplenishmentList.do",{uuid:"",search:"",startDate:"",endDate:"",pageNum:1,pageSize:1e3}).then(function(t){if(0==t.status){var r=[];t.data.map(function(e){r.push({value:e.rmNumber,uuid:e.uuid,erpno:e.erpno})}),e.restaurants=r}else e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})},handleSelect:function(e){var t=this;this.selcetRmNumber=e.value;var r={rmNumber:e.value,uuid:e.uuid};this.erpno=e.erpno,this.form.materialCodingName="",o.a.post(n.a.api,"/replenishment/getReplenishmentInfo.do",r).then(function(e){if(0==e.status){var r=[];e.data.rmProductList.map(function(e){r.push({value:e.productName,dproductUuid:e.uuid,quantity:e.quantity})}),t.materielList=r}else t.$alert(e.msg,{confirmButtonText:"确定",center:!0})})},materielSelect:function(e){this.form.dproductUuid=e.dproductUuid,this.form.quantity=e.quantity,this.getPrintableCount()},getPrintableCount:function(){var e=this;m.open();var t={opid:this.form.dproductUuid,deliveryNumber:this.selcetRmNumber,quantity:this.form.quantity};o.a.post(n.a.api,"/barcode/getMaxPrintableCount.do",t).then(function(t){0==t.status?(e.form.printableQuantity=t.data,m.close()):e.$alert(t.msg,{confirmButtonText:"确定",center:!0,callback:function(e){m.close()}})})},mpAmountBlur:function(){this.form.mpCount="Infinity"==Math.ceil(this.form.deliveryCount/this.form.mpAmount)?0:Math.ceil(this.form.deliveryCount/this.form.mpAmount)},generatingBarcode:function(e){var t=this;this.PrintType="label"==e?"label":"middle"==e?"middle":"accessories",this.$emit("PrintType",this.PrintType),this.$refs.form.validate(function(e){if(e){m.open();var r={deliveryNumber:t.form.rmNumber,printableQuantity:t.form.printableQuantity,mpAmount:t.form.mpAmount,qgPeriod:t.form.qgPeriod,dproductUuid:t.form.dproductUuid,materialCoding:t.form.materialCoding,deliveryCount:t.form.deliveryCount,mpCount:t.form.mpCount,issuanceDate:t.form.issuanceDate,erpno:t.erpno,manufactureDate:t.form.manufactureDate};o.a.post(n.a.api,"/barcode/addAuxiliaryLabel.do",r).then(function(e){0==e.status?(t.getBarcodeList(e.data),m.close()):t.$alert(e.msg,{confirmButtonText:"确定",center:!0,callback:function(e){m.close()}})})}})},getBarcodeList:function(e){var t=this,r={uuid:e,type:1};o.a.post(n.a.api,"/barcode/getAuxiliaryDetailList.do",r).then(function(e){0==e.status?(t.changeBarCodeList(e.data),t.$refs.form.resetFields(),t.form.mpCount=""):t.$alert(e.msg,{confirmButtonText:"确定",center:!0})})}})},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register"},[r("div",{staticClass:"register_center"},[r("el-form",{ref:"form",staticClass:"register_center_center",attrs:{"label-width":"150px",model:e.form,rules:e.rules,size:"mini"}},[r("div",{staticClass:"register_center_left"},[r("el-form-item",{attrs:{label:"补货单号",prop:"rmNumber"}},[r("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{size:"small","fetch-suggestions":e.querySearch,placeholder:"请输入送货单号"},on:{select:e.handleSelect},model:{value:e.form.rmNumber,callback:function(t){e.$set(e.form,"rmNumber",t)},expression:"form.rmNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"可打印数量"}},[r("el-input",{staticClass:"register_input",attrs:{size:"small",placeholder:"打印数量",readonly:""},model:{value:e.form.printableQuantity,callback:function(t){e.$set(e.form,"printableQuantity",t)},expression:"form.printableQuantity"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"最小包装量",prop:"mpAmount"}},[r("el-input",{staticClass:"register_input",attrs:{size:"small",placeholder:"请输入最小包装数",disabled:""==e.form.deliveryCount},on:{blur:e.mpAmountBlur},model:{value:e.form.mpAmount,callback:function(t){e.$set(e.form,"mpAmount",t)},expression:"form.mpAmount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"保质期",prop:"qgPeriod"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.qgPeriod,callback:function(t){e.$set(e.form,"qgPeriod",t)},expression:"form.qgPeriod"}})],1)],1),e._v(" "),r("div",{staticClass:"register_center_right"},[r("el-form-item",{attrs:{label:"物料编码",prop:"materialCodingName"}},[r("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{size:"small","fetch-suggestions":e.materielSearch,placeholder:"请输入物料编码"},on:{select:e.materielSelect},model:{value:e.form.materialCodingName,callback:function(t){e.$set(e.form,"materialCodingName",t)},expression:"form.materialCodingName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"送货数",prop:"deliveryCount"}},[r("el-input",{staticClass:"register_input",attrs:{size:"small",placeholder:"请输入送货数",disabled:""==e.form.printableQuantity},on:{blur:e.mpAmountBlur},model:{value:e.form.deliveryCount,callback:function(t){e.$set(e.form,"deliveryCount",t)},expression:"form.deliveryCount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"最小包装数"}},[r("el-input",{staticClass:"register_input",attrs:{size:"small",placeholder:"最小包装数",readonly:""},model:{value:e.form.mpCount,callback:function(t){e.$set(e.form,"mpCount",t)},expression:"form.mpCount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"送货日期",prop:"issuanceDate"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"送货日期"},model:{value:e.form.issuanceDate,callback:function(t){e.$set(e.form,"issuanceDate",t)},expression:"form.issuanceDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"生产日期",prop:"manufactureDate"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"生产日期"},model:{value:e.form.manufactureDate,callback:function(t){e.$set(e.form,"manufactureDate",t)},expression:"form.manufactureDate"}})],1)],1)]),e._v(" "),r("div",{staticClass:"register_bth_warp"},[r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.generatingBarcode("label")}}},[e._v("生成条形码(100*70)")]),e._v(" "),r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.generatingBarcode("middle")}}},[e._v("生成条形码(100*60)")]),e._v(" "),r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.generatingBarcode("accessories")}}},[e._v("生成条形码(70*45)")])],1)],1)])},staticRenderFns:[]};var f=r("VU/8")(c,d,!1,function(e){r("MsoX")},"data-v-3734417e",null);t.default=f.exports}});
//# sourceMappingURL=89.d493523e1d35567cf7ae.js.map