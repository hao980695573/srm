webpackJsonp([87],{UdbM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),n=a("T452"),l=a("pxwZ"),o=a("lStc"),s=a("uUlv"),u=a("PJh5"),c=a.n(u),d={name:"addInspectionSlip",data:function(){return{screen_data:{deliveryNumber:""},form:{},arrivalDate:"",tableData:[],CountState:!0,errIndex:"",tiNo:"",submitState:!0,fullscreenLoading:!1}},filters:{filtersCount:function(e){return o.a.Remainder(e)},filtersDate:function(e){if(e)return o.a.renderTime(e).slice(0,10)},filterIsGift:function(e){return"0"==e?"否":"是"}},computed:i()({},Object(s.c)(["userId","username"])),methods:{getList:function(){var e=this,t={deliveryNumber:this.screen_data.deliveryNumber};l.a.post(n.a.api,"/stock/getDeliveryDetailByNumber.do",t).then(function(t){0==t.status?null==t.data?(e.form={},e.tableData=[]):(e.form=t.data,"11484"==e.username&&t.data.deliveryProductList.map(function(e){e.warehouse="S06"}),"00042"==e.username&&t.data.deliveryProductList.map(function(e){e.warehouse="S05"}),e.tableData=t.data.deliveryProductList,c()().format("YYYY-MM-DD HH:mm")>=c()().endOf("month").format("YYYY-MM-DD")+" 14:00"?e.arrivalDate=c()().month(c()().month()+1).startOf("month").format("YYYY-MM-DD"):e.arrivalDate=c()().format("YYYY-MM-DD"),t.data.deliveryProductList.map(function(e){e.count=e.quantity})):e.$alert(data.msg,{confirmButtonText:"确定",center:!0})})},watchCount:function(){for(var e=0;e<this.tableData.length;e++){if(this.tableData[e].count>this.tableData[e].quantity){this.CountState=!1,this.errIndex=e;break}this.CountState=!0}},saveBth:function(){var e=this;if(this.submitState&&(this.submitState=!1,this.fullscreenLoading=!0,this.CountState)){var t=this;this.tableData.map(function(e){e.bilNo=e.purchaseOrder,e.prdName=e.productName,e.prdNo=e.productNumber,e.prdMark=e.characteristics,e.qty=e.count,e.itm=e.item,e.wh=e.warehouse,0==e.isGift?e.freeId="false":1==e.isGift&&(e.freeId="true"),e.shNoCus=t.form.deliveryNumber,e.osNo=e.purchaseOrder});var a={receivingUnit:this.form.receivingUnit,currency:this.form.currency,deliveryNumber:this.form.deliveryNumber,tiDd:this.arrivalDate,rem:this.form.remark,cusNo:this.form.erpno,tfTiList:this.tableData,usr:this.userId,companyName:this.form.supplierName,uuid:this.form.uuid,dep:this.tableData[0].useOfDepartmentName};l.a.post(n.a.api,"/stock/saveInspectionSlip.do",a).then(function(a){(t.submitState=!0,t.fullscreenLoading=!1,0==a.status)?e.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.form,e.form.receivingUnit="",e.form.currency="",e.arrivalDate="",e.form.deliveryDate="",e.screen_data.deliveryNumber="",e.form.erpno="",e.form.remark="",e.form.supplierName="",e.tableData=[],e.tiNo=a.data.tiNo}}):e.$alert(a.msg,{confirmButtonText:"确定",center:!0})})}}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"inquiry_warp"},[a("el-form",{ref:"screen_data",attrs:{model:e.screen_data,"label-width":"80px",inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"送货单号"}},[a("el-input",{attrs:{placeholder:"请输入送货单号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.screen_data.deliveryNumber,callback:function(t){e.$set(e.screen_data,"deliveryNumber",t)},expression:"screen_data.deliveryNumber"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"Fuzzy",attrs:{type:"primary"},on:{click:e.getList}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",{attrs:{label:"送检单号"}},[a("el-input",{attrs:{placeholder:"请输入送货单号"},model:{value:e.tiNo,callback:function(t){e.tiNo=t},expression:"tiNo"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"baseWarp"},[a("div",{staticClass:"headerWarp"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",size:"mini","label-position":"right",inline:!0}},[a("el-form-item",{attrs:{label:"进货日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",readonly:"",placeholder:"选择日期"},model:{value:e.form.deliveryDate,callback:function(t){e.$set(e.form,"deliveryDate",t)},expression:"form.deliveryDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"送检日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.arrivalDate,callback:function(t){e.arrivalDate=t},expression:"arrivalDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"收货单位"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.receivingUnit,callback:function(t){e.$set(e.form,"receivingUnit",t)},expression:"form.receivingUnit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供货商"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.supplierName,callback:function(t){e.$set(e.form,"supplierName",t)},expression:"form.supplierName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"币种"}},[a("el-input",{attrs:{readonly:""},model:{value:e.form.currency,callback:function(t){e.$set(e.form,"currency",t)},expression:"form.currency"}})],1),e._v(" "),a("div",[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{staticStyle:{width:"470px"},attrs:{type:"textarea",rows:2,placeholder:"请输入内容",resize:"none"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),a("el-form-item",{staticClass:"save"},[a("el-button",{attrs:{type:"primary",size:"small",disabled:"0"==e.tableData.length},on:{click:e.saveBth}},[e._v("保存")])],1)],1)],1)],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.8)",height:"415",size:"mini"}},[a("el-table-column",{attrs:{align:"center",type:"index",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"productNumber",label:"品号",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"productName",label:"品名","min-width":"170"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"是否赠品",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("filterIsGift")(t.row.isGift)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"仓位",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.row.warehouse,expression:"scope.row.warehouse"}],staticStyle:{width:"100%","line-height":"20px","padding-left":"5px","box-sizing":"border-box",outline:"none"},attrs:{type:"text"},domProps:{value:t.row.warehouse},on:{input:function(a){a.target.composing||e.$set(t.row,"warehouse",a.target.value)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"送货数量",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("filtersCount")(t.row.quantity)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"送检数量","show-overflow-tooltip":"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.row.count,expression:"scope.row.count"}],staticStyle:{width:"100%","line-height":"20px","padding-left":"5px","box-sizing":"border-box",outline:"none"},attrs:{type:"text"},domProps:{value:t.row.count},on:{blur:e.watchCount,input:function(a){a.target.composing||e.$set(t.row,"count",a.target.value)}}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.CountState&&e.errIndex==t.$index,expression:"!CountState&&errIndex==scope.$index"}],staticStyle:{"font-size":"9px",color:"red"}},[e._v("送检数大于送货数")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"采购日期","show-overflow-tooltip":"",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("filtersDate")(t.row.purchaseDate)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"采购单号",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.purchaseOrder))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"单位",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.unit))])]}}])})],1)],1)},staticRenderFns:[]};var f=a("VU/8")(d,m,!1,function(e){a("bDdF")},"data-v-38718329",null);t.default=f.exports},bDdF:function(e,t){}});
//# sourceMappingURL=87.0b0b14993f6fa87142c5.js.map