webpackJsonp([58],{"2RSs":function(e,t){},f6g3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Dd8w"),o=r.n(a),n=r("T452"),l=r("pxwZ"),i=(r("/ksa"),r("uUlv")),m={name:"advicePublish",data:function(){return{flag:!0,header:{Authorization:localStorage.getItem("token")},path:n.a.api+"/file/upFile.do?fileType=other.path",fileList:[],form:{tenderType:"",tenderID:"",projectName:"",temderNumber:"1",BiddingTime:[],startTime:"",endTime:"",tenderingType:"",needNumber:"",otherrequirment:"",contactDept:"",ladderPrice:"",contactName:"",contactPosition:"",contactPhone:"",contactMailbox:"",manufacturerList:[{manufacturerName:"",manufacturerId:""}],enclosure:""},rules:{tenderType:[{required:!0,message:"询报价类型不能为空",trigger:"change"}],projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],BiddingTime:[{required:!0,message:"活动时间不能为空",trigger:"change"}],enclosure:[{required:!0,message:"附件不能为空",trigger:"change"}],tenderingType:[{required:!0,message:"询报价类别不能为空",trigger:["blur","change"]}],needNumber:[{required:!0,message:"投标数量不能为空",trigger:"blur"}],ladderPrice:[{required:!1,message:"标价未税不能为空",trigger:"blur"}]},options:[],restaurants:[{value:"请选择"},{value:"原料"},{value:"色粉抽粒"},{value:"油漆"},{value:"油墨"},{value:"辅料"},{value:"包材"},{value:"模胚"},{value:"钢料"},{value:"铜料"},{value:"刀具"},{value:"模具配件"},{value:"模具加工"},{value:"热流道"},{value:"电镀"},{value:"精雕"},{value:"烫金"},{value:"锌合金"},{value:"镁合金"},{value:"镁合金点胶"},{value:"五金钢壳"},{value:"超声波"},{value:"治具"},{value:"钢片清洗"},{value:"皮套"},{value:"伙食"},{value:"复印费"},{value:"电脑配件"},{value:"机器配件"},{value:"机物料"},{value:"快递"},{value:"水转印"},{value:"水处理"},{value:"水保养"},{value:"工程改造"},{value:"注塑加工"},{value:"机器"},{value:"ERP系统"},{value:"考勤系统"},{value:"铝片"},{value:"福利"},{value:"喷油"},{value:"抛光打砂"},{value:"自动化"},{value:"T处理"},{value:"冷冻批锋"},{value:"天线"},{value:"铝钛合金"},{value:"铝条"},{value:"按键"},{value:"组装"},{value:"镭雕"},{value:"硅胶"},{value:"散热膜"},{value:"光学散光镜"},{value:"镜片"},{value:"工衣"},{value:"软件"},{value:"打标机"},{value:"环保"},{value:"废品"},{value:"日用品"},{value:"劳务派遣"},{value:"培训"},{value:"汽修"},{value:"食品"},{value:"运输"},{value:"租金"},{value:"装修"}]}},computed:o()({},Object(i.c)(["uuid"])),mounted:function(){this.getList(),this.getInformation()},methods:{BiddingTimeChange:function(){this.form.startTime=this.form.BiddingTime[0],this.form.endTime=this.form.BiddingTime[1]},addDomain:function(){this.form.manufacturerList.push({manufacturerName:"",manufacturerId:""})},deleteRules:function(e){-1!==e&&this.form.manufacturerList.splice(e,1)},currentSel:function(e){1==e&&(this.form.manufacturerList=[{manufacturerName:"",manufacturerId:""}])},saveInfor:function(){var e=this;this.flag?(this.flag=!1,this.$refs.base.validate(function(t){t&&e.$refs.formContact.validate(function(t){if(t)if("0"==e.form.tenderType)e.$refs.manufacturerList.validate(function(t){if(t){var r={tenderType:e.form.tenderType,tenderID:e.form.tenderID,projectName:e.form.projectName,temderNumber:Number(e.form.temderNumber),startTime:e.form.startTime,endTime:e.form.endTime,tenderingType:e.form.tenderingType,needNumber:String(e.form.needNumber),otherrequirment:e.form.otherrequirment,ladderPrice:e.form.ladderPrice,contactDept:e.form.contactDept,contactName:e.form.contactName,contactPosition:e.form.contactPosition,contactPhone:e.form.contactPhone,contactMailbox:e.form.contactMailbox,enclosure:e.form.enclosure,manufacturerList:e.form.manufacturerList};l.a.post(n.a.api,"/offermanagement/insertOfferManagement.do",r).then(function(t){0==t.status?e.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.$refs.base.resetFields(),e.$refs.formContact.resetFields(),e.$refs.manufacturerList.resetFields(),e.form.BiddingTime=[],e.form.otherrequirment="",e.form.contactDept="",e.form.contactName="",e.form.contactPosition="",e.$router.push("advice")}}):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}});else{var r={tenderType:e.form.tenderType,tenderID:e.form.tenderID,projectName:e.form.projectName,temderNumber:Number(e.form.temderNumber),startTime:e.form.startTime,endTime:e.form.endTime,tenderingType:e.form.tenderingType,needNumber:String(e.form.needNumber),otherrequirment:e.form.otherrequirment,ladderPrice:e.form.ladderPrice,contactDept:e.form.contactDept,contactName:e.form.contactName,contactPosition:e.form.contactPosition,contactPhone:e.form.contactPhone,contactMailbox:e.form.contactMailbox,enclosure:e.form.enclosure,manufacturerList:e.form.manufacturerList};l.a.post(n.a.api,"/offermanagement/insertOfferManagement.do",r).then(function(t){0==t.status?e.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.$refs.base.resetFields(),e.$refs.formContact.resetFields(),e.$refs.manufacturerList.resetFields(),e.form.BiddingTime=[],e.form.otherrequirment="",e.form.contactDept="",e.form.contactName="",e.form.contactPosition="",e.$router.push("advice")}}):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}})})):this.$alert("正在保存...",{confirmButtonText:"确定",center:!0})},getList:function(){var e=this;l.a.post(n.a.api,"/offermanagement/userList.do").then(function(t){0==t.status&&(e.options=t.data)})},changeFacturerList:function(e,t){for(var r=e,a=this.options,o=0;o<a.length;o++)a[o].companyName==r&&(this.form.manufacturerList[t].manufacturerId=a[o].erpno)},hanldChange:function(){var e=this;e.options.map(function(t,r){for(var a=0;a<e.form.manufacturerList.length;a++)t.erpno==e.form.manufacturerList[a].manufacturerId&&(e.form.manufacturerList[a].manufacturerName=t.companyName)})},otherFileChange:function(e){0==e.errno?(this.form.enclosure=e.data[0],this.fileList.push({name:"附件",url:this.form.enclosure}),this.$refs.formContact.clearValidate("enclosure")):this.$alert(res.msg,{confirmButtonText:"确定",center:!0})},removeOtherFile:function(){this.form.enclosure="",this.fileList=[]},flieErr:function(){this.$alert("文件上传失败",{confirmButtonText:"确定",center:!0})},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，已选择了 "+e.length+" 个文件")},getInformation:function(){var e=this;l.a.post(n.a.api,"/offermanagement/getUserInformation.do").then(function(t){0==t.status?(e.form.contactDept=t.data.username,e.form.contactName=t.data.name,e.form.contactPosition=t.data.role,e.form.contactPhone=t.data.phone,e.form.contactMailbox=t.data.email):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})},querySearch:function(e,t){var r=this.restaurants;t(e?r.filter(this.createFilter(e)):r)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticStyle:{display:"flex","justify-content":"left","align-items":"center","margin-top":"20px","margin-bottom":"20px"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveInfor}},[e._v("保存\n    ")])],1),e._v(" "),r("div",[e._m(0),e._v(" "),r("div",{staticClass:"inquiry_warp"},[r("el-form",{ref:"base",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"询报价类型",prop:"tenderType"}},[r("el-select",{attrs:{placeholder:"请选择询报价类型"},on:{change:e.currentSel},model:{value:e.form.tenderType,callback:function(t){e.$set(e.form,"tenderType",t)},expression:"form.tenderType"}},[r("el-option",{attrs:{label:"指定供应商",value:"0"}}),e._v(" "),r("el-option",{attrs:{label:"所有供应商",value:"1"}})],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:0==e.form.tenderType,expression:"form.tenderType == 0"}],staticClass:"xinadd"},[r("el-form",{ref:"manufacturerList",attrs:{size:"small",model:e.form}},[e._l(e.form.manufacturerList,function(t,a){return r("el-row",{key:a},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"厂商",prop:"manufacturerList."+a+".manufacturerName",rules:[{required:!0,message:"厂商不能为空",trigger:"change"}]}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择厂商"},on:{change:function(t){e.changeFacturerList(t,a)}},model:{value:t.manufacturerName,callback:function(r){e.$set(t,"manufacturerName",r)},expression:"item.manufacturerName"}},e._l(e.options,function(e,t){return r("el-option",{key:t,attrs:{label:e.companyName,value:e.companyName}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:8,offset:1}},[r("el-form-item",{attrs:{label:"代号",prop:"manufacturerList."+a+".manufacturerId",rules:[{required:!0,message:"代号不能为空",trigger:["change","blur"]}]}},[r("el-input",{attrs:{placeholder:"请选择厂商名称"},on:{blur:e.hanldChange},model:{value:t.manufacturerId,callback:function(r){e.$set(t,"manufacturerId",r)},expression:"item.manufacturerId"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6,offset:1}},[r("el-form-item",[e.form.manufacturerList.length>1?r("el-button",{staticStyle:{"margin-top":"30px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteRules(a)}}},[e._v("\n                    删除\n                  ")]):e._e()],1)],1)],1)}),e._v(" "),r("el-button",{on:{click:e.addDomain}},[e._v("新增厂商")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"询报价编号"}},[r("el-input",{attrs:{disabled:"",placeholder:"自动生成询报价编号"},model:{value:e.form.tenderID,callback:function(t){e.$set(e.form,"tenderID",t)},expression:"form.tenderID"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[r("el-input",{model:{value:e.form.projectName,callback:function(t){e.$set(e.form,"projectName",t)},expression:"form.projectName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"询报价类别",prop:"tenderingType"}},[r("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入内容"},model:{value:e.form.tenderingType,callback:function(t){e.$set(e.form,"tenderingType",t)},expression:"form.tenderingType"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"数量",prop:"needNumber"}},[r("el-input",{model:{value:e.form.needNumber,callback:function(t){e.$set(e.form,"needNumber",t)},expression:"form.needNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"询报价轮数"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.temderNumber,callback:function(t){e.$set(e.form,"temderNumber",t)},expression:"form.temderNumber"}},[r("template",{slot:"append"},[e._v("次")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"活动时间",prop:"BiddingTime"}},[r("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss"},on:{change:e.BiddingTimeChange},model:{value:e.form.BiddingTime,callback:function(t){e.$set(e.form,"BiddingTime",t)},expression:"form.BiddingTime"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"inquiry_warp"},[r("el-form",{ref:"formContact",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"阶梯标准",prop:"ladderPrice"}},[r("el-input",{attrs:{placeholder:"如有多个 已;隔开 例如:0-50;50-100;最多5个;默认以K为单位"},model:{value:e.form.ladderPrice,callback:function(t){e.$set(e.form,"ladderPrice",t)},expression:"form.ladderPrice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"其他需求"}},[r("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入其他需求",resize:"none"},model:{value:e.form.otherrequirment,callback:function(t){e.$set(e.form,"otherrequirment",t)},expression:"form.otherrequirment"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"上传附件",prop:"enclosure"}},[r("el-upload",{staticClass:"upload-demo",attrs:{multiple:!1,limit:1,action:e.path,"on-success":e.otherFileChange,headers:e.header,"on-remove":e.removeOtherFile,"on-error":e.flieErr,"file-list":e.fileList,"on-exceed":e.handleExceed}},[r("el-button",{staticStyle:{"margin-left":"30px","margin-top":"3px",width:"200px"},attrs:{size:"small",type:"primary"}},[e._v("上传")])],1)],1)],1)],1)]),e._v(" "),r("div",{staticClass:"inquiry_warp"},[r("div",{staticClass:"lianxi"},[r("el-form",{attrs:{model:e.form,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactDept,callback:function(t){e.$set(e.form,"contactDept",t)},expression:"form.contactDept"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactName,callback:function(t){e.$set(e.form,"contactName",t)},expression:"form.contactName"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"职位"}},[r("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactPosition,callback:function(t){e.$set(e.form,"contactPosition",t)},expression:"form.contactPosition"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"手机号",prop:"contactPhone"}},[r("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactPhone,callback:function(t){e.$set(e.form,"contactPhone",t)},expression:"form.contactPhone"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱",prop:"contactMailbox"}},[r("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactMailbox,callback:function(t){e.$set(e.form,"contactMailbox",t)},expression:"form.contactMailbox"}})],1)],1)],1)],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contacTitleWarp"},[t("div",{staticClass:"contacTitle"},[this._v("询报价信息")])])}]};var s=r("VU/8")(m,c,!1,function(e){r("2RSs")},"data-v-717cf545",null);t.default=s.exports}});
//# sourceMappingURL=58.0ba993f44ce8a96a3718.js.map