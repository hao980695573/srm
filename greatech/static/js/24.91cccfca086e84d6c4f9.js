webpackJsonp([24],{"9cIa":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),o=a("T452"),l=a("pxwZ"),i=(a("/ksa"),a("uUlv")),m={name:"advicePublish",data:function(){return{header:{Authorization:localStorage.getItem("token")},path:o.a.api+"/file/upFile.do?fileType=other.path",fileList:[],form:{tenderType:"",tenderID:"",projectName:"",temderNumber:"1",startTime:"",endTime:"",tenderingType:"",needNumber:"",ladderPrice:"",otherrequirment:"",contactDept:"",contactName:"",contactPosition:"",contactPhone:"",contactMailbox:"",manufacturerList:[{manufacturerName:"",manufacturerId:""}],enclosure:""},BiddingTime:[],rules:{tenderType:[{required:!0,message:"询报价类型不能为空",trigger:"change"}],projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],BiddingTime:[{required:!1,message:"活动时间不能为空",trigger:"change"}],enclosure:[{required:!0,message:"附件不能为空",trigger:"change"}],tenderingType:[{required:!0,message:"询报价类别不能为空",trigger:["blur","change"]}],needNumber:[{required:!0,message:"投标数量不能为空",trigger:"blur"}],ladderPrice:[{required:!1,message:"标价未税不能为空",trigger:"blur"}]},options:[],restaurants:[{value:"请选择"},{value:"原料"},{value:"色粉抽粒"},{value:"油漆"},{value:"油墨"},{value:"辅料"},{value:"包材"},{value:"模胚"},{value:"钢料"},{value:"铜料"},{value:"刀具"},{value:"模具配件"},{value:"模具加工"},{value:"热流道"},{value:"电镀"},{value:"精雕"},{value:"烫金"},{value:"锌合金"},{value:"镁合金"},{value:"镁合金点胶"},{value:"五金钢壳"},{value:"超声波"},{value:"治具"},{value:"钢片清洗"},{value:"皮套"},{value:"伙食"},{value:"复印费"},{value:"电脑配件"},{value:"机器配件"},{value:"机物料"},{value:"快递"},{value:"水转印"},{value:"水处理"},{value:"水保养"},{value:"工程改造"},{value:"注塑加工"},{value:"机器"},{value:"ERP系统"},{value:"考勤系统"},{value:"铝片"},{value:"福利"},{value:"喷油"},{value:"抛光打砂"},{value:"自动化"},{value:"T处理"},{value:"冷冻批锋"},{value:"天线"},{value:"铝钛合金"},{value:"铝条"},{value:"按键"},{value:"组装"},{value:"镭雕"},{value:"硅胶"},{value:"散热膜"},{value:"光学散光镜"},{value:"镜片"},{value:"工衣"},{value:"软件"},{value:"打标机"},{value:"环保"},{value:"废品"},{value:"日用品"},{value:"劳务派遣"},{value:"培训"},{value:"汽修"},{value:"食品"},{value:"运输"},{value:"租金"},{value:"装修"}]}},computed:n()({},Object(i.c)(["uuid"])),mounted:function(){this.getList(),this.getInformation(),this.getViewData()},methods:{BiddingTimeChange:function(){this.form.startTime=this.BiddingTime[0],this.form.endTime=this.BiddingTime[1]},addDomain:function(){this.form.manufacturerList.push({manufacturerName:"",manufacturerId:""})},deleteRules:function(e){-1!==e&&this.form.manufacturerList.splice(e,1)},currentSel:function(e){1==e&&(this.form.manufacturerList=[{manufacturerName:"",manufacturerId:""}])},saveInfor:function(){var e=this;this.$refs.base.validate(function(t){t&&e.$refs.formContact.validate(function(t){if(t)if("0"==e.form.tenderType)e.$refs.manufacturerList.validate(function(t){if(t){var a={uuid:e.uuid,tenderType:e.form.tenderType,tenderID:e.form.tenderID,projectName:e.form.projectName,temderNumber:e.form.temderNumber,startTime:e.form.startTime,endTime:e.form.endTime,ladderPrice:e.form.ladderPrice,tenderingType:e.form.tenderingType,needNumber:String(e.form.needNumber),otherrequirment:e.form.otherrequirment,contactDept:e.form.contactDept,contactName:e.form.contactName,contactPosition:e.form.contactPosition,contactPhone:e.form.contactPhone,contactMailbox:e.form.contactMailbox,enclosure:e.form.enclosure,manufacturerList:e.form.manufacturerList};l.a.post(o.a.api,"/offermanagement/UpdateOfferManagement.do",a).then(function(t){0==t.status?e.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.$router.push("advice")}}):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}});else{var a={uuid:e.uuid,tenderType:e.form.tenderType,tenderID:e.form.tenderID,projectName:e.form.projectName,temderNumber:e.form.temderNumber,startTime:e.form.startTime,endTime:e.form.endTime,ladderPrice:e.form.ladderPrice,tenderingType:e.form.tenderingType,needNumber:String(e.form.needNumber),otherrequirment:e.form.otherrequirment,contactDept:e.form.contactDept,contactName:e.form.contactName,contactPosition:e.form.contactPosition,contactPhone:e.form.contactPhone,contactMailbox:e.form.contactMailbox,enclosure:e.form.enclosure,manufacturerList:e.form.manufacturerList};l.a.post(o.a.api,"/offermanagement/UpdateOfferManagement.do",a).then(function(t){0==t.status?e.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.$router.push("advice")}}):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}})})},getList:function(){var e=this;l.a.post(o.a.api,"/offermanagement/userList.do").then(function(t){0==t.status&&(e.options=t.data)})},changeFacturerList:function(e,t){for(var a=e,r=this.options,n=0;n<r.length;n++)r[n].companyName==a&&(this.form.manufacturerList[t].manufacturerId=r[n].erpno)},hanldChange:function(){var e=this;e.options.map(function(t,a){for(var r=0;r<e.form.manufacturerList.length;r++)t.erpno==e.form.manufacturerList[r].manufacturerId&&(e.form.manufacturerList[r].manufacturerName=t.companyName)})},otherFileChange:function(e){0==e.errno?(this.form.enclosure=e.data[0],this.fileList.push({name:"附件",url:this.form.enclosure}),this.$refs.formContact.clearValidate("enclosure")):this.$alert(res.msg,{confirmButtonText:"确定",center:!0})},removeOtherFile:function(){this.form.enclosure="",this.fileList=[]},flieErr:function(){this.$alert("文件上传失败",{confirmButtonText:"确定",center:!0})},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，已选择了 "+e.length+" 个文件")},getInformation:function(){var e=this;l.a.post(o.a.api,"/offermanagement/getUserInformation.do").then(function(t){0==t.status?(e.form.contactDept=t.data.username,e.form.contactName=t.data.name,e.form.contactPosition=t.data.role,e.form.contactPhone=t.data.phone,e.form.contactMailbox=t.data.email):e.$alert(t.msg,{confirmButtonText:"确定",center:!0})})},getViewData:function(){var e=this,t={uuid:this.uuid};l.a.post(o.a.api,"/offermanagement/getInformationList.do",t).then(function(t){0==t.status&&(e.form=t.data,e.BiddingTime.push(t.data.startTime,t.data.endTime))})},querySearch:function(e,t){var a=this.restaurants;t(e?a.filter(this.createFilter(e)):a)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{display:"flex","justify-content":"left","align-items":"center","margin-top":"20px","margin-bottom":"20px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.saveInfor}},[e._v("保存\n    ")])],1),e._v(" "),a("div",[e._m(0),e._v(" "),a("div",{staticClass:"inquiry_warp"},[a("el-form",{ref:"base",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"询报价类型",prop:"tenderType"}},[a("el-select",{attrs:{placeholder:"请选择询报价类型",disabled:""},on:{change:e.currentSel},model:{value:e.form.tenderType,callback:function(t){e.$set(e.form,"tenderType",t)},expression:"form.tenderType"}},[a("el-option",{attrs:{label:"指定供应商",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"所有供应商",value:"1"}})],1)],1),e._v(" "),0==e.form.tenderType?a("div",{staticClass:"changshang"},[a("el-form",{ref:"manufacturerList",attrs:{size:"small",model:e.form}},[e._l(e.form.manufacturerList,function(t,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"厂商",prop:"manufacturerList."+r+".manufacturerName",rules:[{required:!0,message:"厂商不能为空",trigger:"change"}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择厂商",disabled:""},on:{change:function(t){e.changeFacturerList(t,r)}},model:{value:t.manufacturerName,callback:function(a){e.$set(t,"manufacturerName",a)},expression:"item.manufacturerName"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.companyName,value:e.companyName}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8,offset:1}},[a("el-form-item",{attrs:{label:"代号",prop:"manufacturerList."+r+".manufacturerId",rules:[{required:!0,message:"代号不能为空",trigger:["change","blur"]}]}},[a("el-input",{attrs:{placeholder:"请选择厂商名称",disabled:""},on:{blur:e.hanldChange},model:{value:t.manufacturerId,callback:function(a){e.$set(t,"manufacturerId",a)},expression:"item.manufacturerId"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6,offset:1}},[a("el-form-item",[e.form.manufacturerList.length>1?a("el-button",{staticStyle:{"margin-top":"30px"},attrs:{type:"danger",size:"mini",disabled:""},on:{click:function(t){return e.deleteRules(r)}}},[e._v("\n                    删除\n                  ")]):e._e()],1)],1)],1)}),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:""},on:{click:e.addDomain}},[e._v("新增厂商")])],2)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"询报价编号"}},[a("el-input",{attrs:{disabled:"",placeholder:"自动生成询报价编号"},model:{value:e.form.tenderID,callback:function(t){e.$set(e.form,"tenderID",t)},expression:"form.tenderID"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[a("el-input",{model:{value:e.form.projectName,callback:function(t){e.$set(e.form,"projectName",t)},expression:"form.projectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"询报价类别",prop:"tenderingType"}},[a("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入内容"},model:{value:e.form.tenderingType,callback:function(t){e.$set(e.form,"tenderingType",t)},expression:"form.tenderingType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"投标数量",prop:"needNumber"}},[a("el-input",{model:{value:e.form.needNumber,callback:function(t){e.$set(e.form,"needNumber",t)},expression:"form.needNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"询报价轮数"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.temderNumber,callback:function(t){e.$set(e.form,"temderNumber",t)},expression:"form.temderNumber"}},[a("template",{slot:"append"},[e._v("次")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"活动时间",prop:"BiddingTime"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss"},on:{change:e.BiddingTimeChange},model:{value:e.BiddingTime,callback:function(t){e.BiddingTime=t},expression:"BiddingTime"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"inquiry_warp"},[a("el-form",{ref:"formContact",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"阶梯标准",prop:"ladderPrice"}},[a("el-input",{attrs:{placeholder:"如有多个 已;隔开 例如:0-50;50-100;"},model:{value:e.form.ladderPrice,callback:function(t){e.$set(e.form,"ladderPrice",t)},expression:"form.ladderPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"其他需求"}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入其他需求",resize:"none"},model:{value:e.form.otherrequirment,callback:function(t){e.$set(e.form,"otherrequirment",t)},expression:"form.otherrequirment"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传附件",prop:"enclosure"}},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:!1,limit:1,action:e.path,"on-success":e.otherFileChange,headers:e.header,"on-remove":e.removeOtherFile,"on-error":e.flieErr,"file-list":e.fileList,"on-exceed":e.handleExceed}},[a("el-button",{staticStyle:{"margin-left":"30px","margin-top":"3px",width:"200px"},attrs:{size:"small",type:"primary"}},[e._v("上传")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactDept,callback:function(t){e.$set(e.form,"contactDept",t)},expression:"form.contactDept"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactName,callback:function(t){e.$set(e.form,"contactName",t)},expression:"form.contactName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职位"}},[a("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactPosition,callback:function(t){e.$set(e.form,"contactPosition",t)},expression:"form.contactPosition"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"手机号",prop:"contactPhone"}},[a("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactPhone,callback:function(t){e.$set(e.form,"contactPhone",t)},expression:"form.contactPhone"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"邮箱",prop:"contactMailbox"}},[a("el-input",{attrs:{placeholder:"无",readonly:""},model:{value:e.form.contactMailbox,callback:function(t){e.$set(e.form,"contactMailbox",t)},expression:"form.contactMailbox"}})],1)],1)],1)],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"contacTitleWarp"},[t("div",{staticClass:"contacTitle"},[this._v("询报价信息")])])}]};var c=a("VU/8")(m,u,!1,function(e){a("u8r4")},"data-v-f153980a",null);t.default=c.exports},u8r4:function(e,t){}});
//# sourceMappingURL=24.91cccfca086e84d6c4f9.js.map