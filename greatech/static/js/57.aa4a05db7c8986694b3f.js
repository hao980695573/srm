webpackJsonp([57],{"9Ocy":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),o=a.n(i),n=a("T452"),r=a("pxwZ"),l=a("uUlv"),s={name:"Inquiry",data:function(){return{headerToken:{Authorization:localStorage.getItem("token")},screen_data:{companyType:"",isNeedExamination:"",conditionContent:""},tableData:[],totalNum:1,currentPage:1,ShowPage:15,AuditorShow:!1,form:{isAuditor:""},AuditorDataShow:!1,AuditorData:{auditorOpinion:"",dataUpload:"",type:"",isNeedExamination:""},rules:{auditorOpinion:[{required:!0,message:"审厂意见不能为空",trigger:"blur"}],dataUpload:[{required:!0,message:"审厂资料不能为空",trigger:"change"}]}}},filters:{formatState:function(t){return 0==t?"待审核":1==t?"现场审核中":2==t?"审厂通过":3==t?"审厂不通过":4==t?"初步审核通过":5==t?"初步审核不通过":6==t?"终审通过":7==t?"终审不通过":void 0},formatType:function(t){return 0==t?"国有企业":1==t?"集体企业":2==t?"私营企业":3==t?"个体工商户":4==t?"合作企业":5==t?"联营企业":6==t?"股份合作制企业":7==t?"有限责任公司":8==t?"股份有限公司":void 0},formatAuditor:function(t){return 0==t?"否":1==t?"是":void 0}},mounted:function(){this.changePage()},computed:o()({},Object(l.c)(["uuid","publicState","userRole"])),methods:o()({},Object(l.b)(["changeUuid","changeState"]),{changePage:function(t){var e=this;"screen"==t&&(this.currentPage=1);var a={uuid:this.uuid,companyType:this.screen_data.companyType,isNeedExamination:this.screen_data.isNeedExamination,conditionContent:this.screen_data.conditionContent,pageSize:this.ShowPage,pageNum:this.currentPage};r.a.post(n.a.api,"/supplier/getBeAuditSupplierList.do",a).then(function(t){e.tableData=t.data,t.data.length>0&&(e.totalNum=t.data[0].totalNum)})},downloadfile:function(t){window.open(t.row.certificateList[0].filePath)},hladAuditorShow:function(t){this.AuditorShow=!0,this.changeUuid(t.row.uuid),this.changeState(t.row.status)},setAuditor:function(){var t=this,e={uuid:this.uuid,operateType:"check",status:this.publicState,isNeedExamination:this.form.isAuditor};r.a.post(n.a.api,"/supplier/auditSupplier.do",e).then(function(e){var a=t;0==e.status?t.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){a.AuditorShow=!1,a.changePage()}}):t.$alert(e.msg,{confirmButtonText:"确定",center:!0})})},refuseApply:function(t,e){var a=this,i="";if(this.changeUuid(t.row.uuid),"agree"==e)if(i=e,"1"==t.row.status)this.AuditorDataShow=!0,this.changeState(t.row.status),this.AuditorData.type=i,this.AuditorData.isNeedExamination=t.row.isNeedExamination;else{var o={uuid:t.row.uuid,operateType:i,status:t.row.status,auditOpinion:"",isNeedExamination:t.row.isNeedExamination};r.a.post(n.a.api,"/supplier/auditSupplier.do",o).then(function(t){var e=a;0==t.status?a.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.changePage()}}):a.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}else if("reject"==e)if(i=e,"1"==t.row.status)this.AuditorDataShow=!0,this.changeState(t.row.status),this.AuditorData.type=i,this.AuditorData.isNeedExamination=t.row.isNeedExamination;else{var l={uuid:t.row.uuid,operateType:i,status:t.row.status,auditOpinion:"",isNeedExamination:t.row.isNeedExamination};r.a.post(n.a.api,"/supplier/auditSupplier.do",l).then(function(t){var e=a;0==t.status?a.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){e.changePage()}}):a.$alert(t.msg,{confirmButtonText:"确定",center:!0})})}},AuditorFileChange:function(t){this.AuditorData.dataUpload=t.data[0],this.$refs.AuditorData.clearValidate(["dataUpload"])},removeAuditorFile:function(){this.AuditorData.dataUpload=""},addOpinionData:function(){var t=this;this.$refs.AuditorData.validate(function(e){if(e){var a={uuid:t.uuid,auditOpinion:t.AuditorData.auditorOpinion,filePath:t.AuditorData.dataUpload,operateType:t.AuditorData.type,status:t.publicState,isNeedExamination:t.AuditorData.isNeedExamination};r.a.post(n.a.api,"/supplier/auditSupplier.do",a).then(function(e){var a=t;0==e.status?t.$alert("保存成功",{confirmButtonText:"确定",center:!0,callback:function(t){a.AuditorDataShow=!1,a.AuditorData.auditorOpinion="",a.AuditorData.dataUpload="",a.changePage()}}):t.$alert(e.msg,{confirmButtonText:"确定",center:!0})})}})},ViewAudit:function(t){this.changeUuid(t.row.uuid),0==t.row.status?this.$router.push("seeBeAudited"):this.$router.push("viewManufacturer")}})},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"inquiry_warp"},[a("el-form",{ref:"screen_data",attrs:{model:t.screen_data,"label-width":"80px",inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"企业类型"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:t.screen_data.companyType,callback:function(e){t.$set(t.screen_data,"companyType",e)},expression:"screen_data.companyType"}},[a("el-option",{attrs:{label:"请选择",value:" "}}),t._v(" "),a("el-option",{attrs:{label:"生产商",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"代理商",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"承运商",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"服务类",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"其他",value:"4"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"现场审厂"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:t.screen_data.isNeedExamination,callback:function(e){t.$set(t.screen_data,"isNeedExamination",e)},expression:"screen_data.isNeedExamination"}},[a("el-option",{attrs:{label:"请选择",value:" "}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"是",value:"1"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"模糊搜索"}},[a("el-input",{attrs:{placeholder:"模糊搜索"},model:{value:t.screen_data.conditionContent,callback:function(e){t.$set(t.screen_data,"conditionContent",e)},expression:"screen_data.conditionContent"}})],1),t._v(" "),a("el-form-item",[a("el-button",{staticClass:"Fuzzy",attrs:{type:"primary"},on:{click:function(e){return t.changePage("screen")}}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.8)",height:"415",size:"mini"}},[a("el-table-column",{attrs:{align:"center",prop:"companyName",label:"公司名称","show-overflow-tooltip":"",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"企业性质",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatType")(e.row.companyNature)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contractList[0].name","show-overflow-tooltip":"",label:"联系人","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contractList[0].post",label:"职位",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"contractList[0].phone",label:"电话",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"是否审厂",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatAuditor")(e.row.isNeedExamination)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:[{pass:2==e.row.status||4==e.row.status||6==e.row.status},{fail:3==e.row.status||5==e.row.status||7==e.row.status}]},[t._v(t._s(t._f("formatState")(e.row.status)))])]}}])}),t._v(" "),"ROLE_ADMIN"==t.userRole?a("el-table-column",{attrs:{align:"center",label:"审厂资料",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.row.certificateList[0],expression:"scope.row.certificateList[0]"}],attrs:{type:"text",size:"mini"},on:{click:function(a){return t.downloadfile(e)}}},[t._v("下载")])]}}],null,!1,3210535160)}):t._e(),t._v(" "),"ROLE_ADMIN"==t.userRole?a("el-table-column",{attrs:{align:"center",prop:"auditOpinion",label:"审厂意见","show-overflow-tooltip":"","min-width":"200"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注","show-overflow-tooltip":"","min-width":"200"}}),t._v(" "),"ROLE_ADMIN"==t.userRole||"PURCHASER"==t.userRole||"PURCHASER_MANAGER"==t.userRole?a("el-table-column",{attrs:{align:"center",label:"操作",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini",disabled:0!=e.row.status||0==e.row.isNeedExamination},on:{click:function(a){return t.hladAuditorShow(e)}}},[t._v("\n          审厂\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",disabled:"0"!=e.row.status&&"1"!=e.row.status&&"4"!=e.row.status},on:{click:function(a){return t.refuseApply(e,"agree")}}},[t._v("\n          通过\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",disabled:"0"!=e.row.status&&"1"!=e.row.status&&"4"!=e.row.status},on:{click:function(a){return t.refuseApply(e,"reject")}}},[t._v("\n          拒绝\n        ")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.ViewAudit(e)}}},[t._v("\n          查看\n        ")])]}}],null,!1,1982722003)}):t._e()],1),t._v(" "),a("div",{staticClass:"page_fen"},[a("el-pagination",{attrs:{background:"","page-size":t.ShowPage,layout:"prev, pager, next",total:t.totalNum,"current-page":t.currentPage},on:{"current-change":t.changePage,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t._v(" "),a("el-dialog",{attrs:{title:"是否审厂",visible:t.AuditorShow,center:"",width:"350px"},on:{"update:visible":function(e){t.AuditorShow=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",inline:""}},[a("el-form-item",{attrs:{label:"是否审厂"}},[a("el-radio-group",{model:{value:t.form.isAuditor,callback:function(e){t.$set(t.form,"isAuditor",e)},expression:"form.isAuditor"}},[a("el-radio",{attrs:{label:"0"}},[t._v("否")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("是")])],1)],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"primary"},on:{click:t.setAuditor}},[t._v("确定")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"意见和资料",visible:t.AuditorDataShow},on:{"update:visible":function(e){t.AuditorDataShow=e}}},[a("el-form",{ref:"AuditorData",attrs:{model:t.AuditorData,rules:t.rules,"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:"审厂意见",prop:"auditorOpinion"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入审厂意见",resize:"none"},model:{value:t.AuditorData.auditorOpinion,callback:function(e){t.$set(t.AuditorData,"auditorOpinion",e)},expression:"AuditorData.auditorOpinion"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"厂商资料上传",prop:"dataUpload"}},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:!1,limit:1,action:"http://www.srm-greatech.com/gzSrm/system/file/upFile.do?fileType=qualification.path","on-success":t.AuditorFileChange,"on-remove":t.removeAuditorFile,headers:t.headerToken,"file-list":[]}},[a("el-button",{staticStyle:{"margin-left":"30px","margin-top":"3px",width:"200px"},attrs:{size:"small",type:"success"}},[t._v("上传")])],1)],1)],1),t._v(" "),a("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center","align-items":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addOpinionData}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(s,u,!1,function(t){a("sxlo")},"data-v-72502d03",null);e.default=d.exports},sxlo:function(t,e){}});
//# sourceMappingURL=57.aa4a05db7c8986694b3f.js.map