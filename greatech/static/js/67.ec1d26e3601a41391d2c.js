webpackJsonp([67],{NupU:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("Dd8w"),a=i.n(r),l=i("T452"),n=i("pxwZ"),d=i("lStc"),s=i("uUlv"),u={name:"addLeivery",data:function(){var e=this;return{DeliveryShow:!1,deLiveryForm:[],addLeiveryList:{quantity:"",planTime:""},deliveryNumber:"请选择时间",avaiableDate:"",pickerOptions:{disabledDate:function(t){return""==e.avaiableDate?t.getTime()<Date.parse(e.orderOneDate)-864e5:t.getTime()<Date.parse(e.avaiableDate)}},rules:{quantity:[{validator:function(t,i,r){""===i?r(new Error("请输入数量")):/^[0-9]*[1-9][0-9]*$/.test(i)?Number(i)>e.deliveryNumber?r(new Error("排程数量大于总数量")):r():r(new Error("只能填写整数"))},required:!0,trigger:"blur"}],planTime:[{required:!0,message:"请选择日期",trigger:"change"}]}}},computed:a()({},Object(s.c)(["purchaseOrder","orderCount","productUuid","orderOneDate"]),{filterOrderCount:function(){return d.a.Remainder(this.orderCount).slice(0,10)}}),filters:{filterQuantity:function(e){if(substring,e)return d.a.Remainder(e)},filterPlanTime:function(e){if(e)return d.a.renderTime(e).slice(0,10)}},mounted:function(){this.getDelivery()},methods:{addDeliveryShow:function(){this.DeliveryShow=!0},changeDate:function(e){var t=this;this.$refs.addLeiveryList.clearValidate("quantity");var i={purchaseOrder:this.purchaseOrder,uuid:this.productUuid,createDate:e};n.a.post(l.a.api,"/delivery/getMaxDeliveryCount.do",i).then(function(e){0==e.status&&(e.data>0?t.deliveryNumber=e.data:t.deliveryNumber="0.00")})},addSure:function(){var e=this;this.$refs.addLeiveryList.validate(function(t){if(t){var i={quantity:e.addLeiveryList.quantity,planTime:e.addLeiveryList.planTime,purchaseOrder:e.purchaseOrder,orderCount:e.orderCount,productUuid:e.productUuid};n.a.post(l.a.api,"/delivery/saveDeliveryPlan.do",i).then(function(t){0==t.status&&e.$alert(t.msg,{confirmButtonText:"确定",center:!0,callback:function(t){e.deliveryNumber="请选择时间",e.$refs.addLeiveryList.resetFields(),e.DeliveryShow=!1,e.getDelivery()}})})}})},getDelivery:function(){var e=this,t={uuid:this.productUuid,purchaseOrder:this.purchaseOrder};n.a.post(l.a.api,"/delivery/getDeliveryPlanList.do",t).then(function(t){0==t.status&&(e.deLiveryForm=t.data,t.data.length>0&&(e.avaiableDate=d.a.renderTime(t.data[t.data.length-1].planTime).slice(0,10)))})}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"contacTitleWarp",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"contacTitle"},[e._v("送货排程")]),e._v(" "),i("div",{staticClass:"contacTitleButton"},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:""==e.orderOneDate},on:{click:e.addDeliveryShow}},[e._v("新增")])],1)]),e._v(" "),i("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.deLiveryForm,border:"",height:"400px",size:"mini","show-summary":""}},[i("el-table-column",{attrs:{type:"index",align:"center",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{prop:"quantity",label:"数量",align:"center","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("filterQuantity")(t.row.quantity)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"日期",align:"center","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("filterPlanTime")(t.row.planTime)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n          申请调整\n        ")])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:"新增送货排程",visible:e.DeliveryShow,width:"600px"},on:{"update:visible":function(t){e.DeliveryShow=t}}},[i("el-form",{ref:"addLeiveryList",attrs:{model:e.addLeiveryList,rules:e.rules,size:"mini"}},[i("el-form-item",{attrs:{label:"需求总数量"}},[i("el-input",{attrs:{placeholder:"无数据",disabled:""},model:{value:e.filterOrderCount,callback:function(t){e.filterOrderCount=t},expression:"filterOrderCount"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"可排程数量"}},[i("el-input",{attrs:{placeholder:"请选择时间",disabled:""},model:{value:e.deliveryNumber,callback:function(t){e.deliveryNumber=t},expression:"deliveryNumber"}})],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:10}},[i("el-form-item",{attrs:{label:"数量",prop:"quantity"}},[i("el-input",{attrs:{placeholder:"请输入数量",disabled:"0.00"==e.deliveryNumber||"请选择时间"==e.deliveryNumber},model:{value:e.addLeiveryList.quantity,callback:function(t){e.$set(e.addLeiveryList,"quantity",t)},expression:"addLeiveryList.quantity"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:10,offset:4}},[i("el-form-item",{attrs:{label:"时间",prop:"planTime"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,placeholder:"选择日期"},on:{change:e.changeDate},model:{value:e.addLeiveryList.planTime,callback:function(t){e.$set(e.addLeiveryList,"planTime",t)},expression:"addLeiveryList.planTime"}})],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"bth"},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:"0.00"==e.deliveryNumber||"请选择时间"==e.deliveryNumber},on:{click:e.addSure}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var c=i("VU/8")(u,o,!1,function(e){i("lxeM")},"data-v-5e936d64",null);t.default=c.exports},lxeM:function(e,t){}});
//# sourceMappingURL=67.ec1d26e3601a41391d2c.js.map