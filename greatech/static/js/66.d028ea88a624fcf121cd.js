webpackJsonp([66],{P01g:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("mvHQ"),i=a.n(l),s=a("Dd8w"),n=a.n(s),r=a("T452"),o=a("pxwZ"),c=a("lStc"),u=a("uUlv"),p={name:"manifest",data:function(){return{screen_list:{search:""},tableData:[],pageNum:1,pageSize:50,totalNum:0,hladpageSize:4,a:[],bb:[],selectData:[]}},computed:n()({},Object(u.c)(["stateDelivery"])),filters:{filtersPurchaseDate:function(e){if(e)return c.a.renderTime(e).slice(0,10)},filtersQuantity:function(e){return c.a.Remainder(e)},filterIsGift:function(e){return"0"==e?"否":"是"},filteHurry:function(e){return"1"==e?"紧急":"否"}},mounted:function(){this.getList(),this.changeStateDelivery([])},methods:n()({},Object(u.b)(["changeStateDelivery"]),{getList:function(e){var t=this;"search"==e&&(this.pageNum=1,this.pageSize=Number(this.hladpageSize));var a={uuid:"",search:this.screen_list.search,pageNum:this.pageNum,pageSize:this.pageSize};o.a.post(r.a.api,"/delivery/beDeliveryList.do",a).then(function(e){0==e.status?(t.tableData=e.data,t.tableData.map(function(e){e.isGift="0"}),t.totalNum=e.data[0].totalNum):t.$alert(data.msg,{confirmButtonText:"确定",center:!0})})},handleSelectionChange:function(e){for(var t=!0,a=0;a<e.length;a++)if(1!=e[a].isGift)for(var l=0;l<this.tableData.length;l++)this.tableData[l].productNumber==e[a].productNumber&&this.tableData[l].purchaseOrder.substr(2)<e[a].purchaseOrder.substr(2)&&(this.$refs.tableData.toggleRowSelection(e[a],!1),t=!1,this.$alert("该"+this.tableData[l].productNumber+"品号下，"+this.tableData[l].purchaseOrder+"订单还未送完",{confirmButtonText:"确定",center:!0}));t&&(this.selectData=e,this.changeStateDelivery(e))},AllDetail:function(){this.selectData="",this.changeStateDelivery([]),this.$refs.tableData.clearSelection()},generate:function(){this.$router.push("deliveryNote")},duplicate:function(){for(var e=this,t=this,a=0;a<t.stateDelivery.length;a++)for(var l=0,s=0;s<t.tableData.length;s++){for(var n=0;n<t.bb.length;n++)if(t.bb[n].opid==t.stateDelivery[a].opid&&t.bb[n].planTime==t.stateDelivery[a].planTime&&t.bb[n].purchaseDate==t.stateDelivery[a].purchaseDate){l=1;break}if(1==l)break;if(t.tableData[s].opid==t.stateDelivery[a].opid&&t.tableData[s].planTime==t.stateDelivery[a].planTime&&t.tableData[s].purchaseDate==t.stateDelivery[a].purchaseDate){var r=JSON.parse(i()(t.stateDelivery[a]));r.deliverableQuantity=t.tableData[s].bpCount,r.isGift="1",this.a.push({index:s,b:r})}}this.a.map(function(a,l){for(var i=0;i<t.tableData.length;i++)if(a.b.opid==t.tableData[i].opid&&t.tableData[i].planTime==a.b.planTime&&t.tableData[i].purchaseDate==a.b.purchaseDate){e.bb.push(a.b),e.tableData.splice(i+1,0,a.b);break}}),this.a=[];var o=this.selectData;this.$refs.tableData.clearSelection(),t.tableData.map(function(t,a){for(var l=0;l<o.length;l++)if(t.opid==o[l].opid&&t.planTime==o[l].planTime&&t.purchaseDate==o[l].purchaseDate){e.$refs.tableData.toggleRowSelection(t);break}})}})},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"inquiry_warp"},[a("el-form",{ref:"screen_list",attrs:{model:e.screen_list,inline:!0,"label-width":"80px",size:"mini"}},[a("el-form-item",{attrs:{label:"模糊搜索"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.screen_list.search,callback:function(t){e.$set(e.screen_list,"search",t)},expression:"screen_list.search"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getList}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"success",disabled:e.stateDelivery.length<="0"},on:{click:e.generate}},[e._v("生成送货单")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"success",disabled:e.stateDelivery.length<="0"},on:{click:e.duplicate}},[e._v("生成赠品")])],1)],1)],1),e._v(" "),a("el-table",{ref:"tableData",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",heigh:"415","element-loading-background":"rgba(0, 0, 0, 0.8)",size:"mini"},on:{"selection-change":e.handleSelectionChange,"select-all":e.AllDetail}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"紧急状态","show-overflow-tooltip":"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{jinji:1==t.row.isHurry}]},[e._v(e._s(e._f("filteHurry")(t.row.isHurry)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"采购日期","show-overflow-tooltip":"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(e._f("filtersPurchaseDate")(t.row.purchaseDate)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"排程日期",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.planTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"采购单号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.purchaseOrder))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"品号",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.productNumber))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"品名","show-overflow-tooltip":"","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.productName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","show-overflow-tooltip":"",label:"供货商","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.supplierName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"单位",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(t.row.unit))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"是否赠送",width:"75"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(e._f("filterIsGift")(t.row.isGift)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"订单数量",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(e._f("filtersQuantity")(t.row.count)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"当前可送数量","show-overflow-tooltip":"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:[{zhensong:1==t.row.isGift}]},[e._v(e._s(e._f("filtersQuantity")(t.row.deliverableQuantity)))])]}}])})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"0"==!e.tableData.length,expression:'!tableData.length=="0"'}],staticClass:"page_fen"},[a("el-pagination",{attrs:{background:"","page-size":e.pageSize,layout:"prev, pager, next",total:e.totalNum,"current-page":e.pageNum},on:{"current-change":e.getList,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}),e._v(" "),a("div",{staticClass:"tiaoshu"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:e.hladpageSize,callback:function(t){e.hladpageSize=t},expression:"hladpageSize"}},[a("template",{slot:"append"},[e._v("最多"+e._s(e.totalNum)+"条")])],2)],1),e._v(" "),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{staticClass:"Fuzzy",attrs:{type:"primary",size:"mini",disabled:e.hladpageSize>e.totalNum},on:{click:function(t){return e.getList("search")}}},[e._v("搜索\n      ")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(p,f,!1,function(e){a("vSEg")},"data-v-60404ee8",null);t.default=h.exports},vSEg:function(e,t){}});
//# sourceMappingURL=66.d028ea88a624fcf121cd.js.map